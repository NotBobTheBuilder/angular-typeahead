angular.module("siyfion.sfTypeahead",[]).directive("sfTypeahead",function(){return{restrict:"AC",require:"?ngModel",scope:{options:"=",datasets:"=",suggestionKey:"@"},link:function(a,b,c,d){function e(b,c){a.$apply(function(){var b=angular.isDefined(a.suggestionKey)?c[a.suggestionKey]:c;d.$setViewValue(b)})}var f=a.options||{},g=(angular.isArray(a.datasets)?a.datasets:[a.datasets])||[];b.typeahead(a.options,a.datasets),d.$parsers.push(function(a){var b=angular.isObject(a);return f.editable===!1?(d.$setValidity("typeahead",b),b?a:void 0):a}),d.$formatters.push(function(a){if(angular.isObject(a)){var c;return $.each(g,function(b,d){var e=d.displayKey||"value",f=(angular.isFunction(e)?e(a):a[e])||"";f&&!c&&(c=f)}),c}return null==a?void b.typeahead("val",null):a}),b.bind("typeahead:selected",function(b,c,d){e(b,c,d),a.$emit("typeahead:selected",c,d)}),b.bind("typeahead:autocompleted",function(b,c,d){e(b,c,d),a.$emit("typeahead:autocompleted",c,d)}),b.bind("typeahead:opened",function(){a.$emit("typeahead:opened")}),b.bind("typeahead:closed",function(){a.$emit("typeahead:closed")}),b.bind("typeahead:cursorchanged",function(b,c,d){a.$emit("typeahead:cursorchanged",b,c,d)})}}});